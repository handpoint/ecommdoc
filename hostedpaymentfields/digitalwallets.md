---
sidebar_position: 24
---

# Apple Pay / Google Pay

## Background 

The Gateway supports payments made using the following Digital Wallets, Apple Pay and Google Pay™. These wallets can be used to enhance mobile purchasing experiences for
customers with supported devices and produce a payment token which can be passed to the Gateway instead of the Cardholder’s actual card details.

You can use these wallets with any Merchant Account that has been configured to accept them.

For more information on how to accept payment tokens, please contact customer support.

:::tip 
Digital wallet support is not available with all Acquirers and must be enabled on your Merchant Account before they can be used. Please contact support to find out whether your Acquirer supports Digital Wallets and if the functionality can be enabled on your Merchant Account.
::: 

## Benefits 

- The payment details are stored externally to the Gateway and can be used with any Merchant that supports the appropriate payment tokens.
- Customers can select from previously stored payment details, making the checkout process more streamlined, resulting in fewer abandoned carts and thus increasing sales.
- Compatible with existing card base fraud solutions such as Address Verification Service (AVS), 3-D Secure and third-party fraud providers.
- There are no extra costs to add these payment methods to your Gateway account.
- The transactions are controlled within the Merchant Management System (MMS) in the same manner as normal card transactions.

## Limitations 
- Your Customer will need a digital wallet enabled device with some stored card details in
order to make full use of this payment method.
- The device needs to be integrated with the Gateway using third-party provided software.
- Repeat transactions using the retrieved payment details are supported.

## Configuration 

The Merchant Account being used for the payments must be configured with your Digital Wallet credentials so that the Gateway can decrypt the payment token.

### Apple Pay configuration 

Apple Pay requires the Gateway to generate public/private key pair and then the public key must be shared with your Apple Pay enabled application in the guise of an Apple Pay payment process certificate.

To configure an Apple Pay [payment processing certificate](https://help.apple.com/developer-account/#/devb2e62b839?sub=devf31990e3f) you must have enrolled in the [Apple Developer Program](https://developer.apple.com/programs/)and [created a unique Apple Pay merchant identifier](https://help.apple.com/developer-account/#/devb2e62b839?sub=dev103e030bb).

The payment processing certificate is associated with your merchant identifier and used to encrypt payment information. The certificate expires every 25 months. If the certificate is revoked, you can recreate it.

You would normally use the Merchant Management System (MMS) to configure your [payment processing certificate](https://help.apple.com/developer-account/#/devb2e62b839?sub=devf31990e3f) by following the steps outlined below:

1. Open the [Apple Developer Certificates, Identifiers & Profiles](https://idmsa.apple.com/IDMSWebAuth/signin?appIdKey=891bd3417a7776362562d2197f89480a8547b108fd934911bcbea0110d07f757&path=%2Faccount%2Fresources%2F&rv=1) webpage and select
'Identifiers' from the sidebar.
2. Under 'Identifiers', select 'Merchant IDs' using the filter in the top-right.
3. On the right, select your merchant identifier.
4. Under 'Apple Pay Payment Processing Certificate', click 'Create Certificate'.
5. Download our certificate signing request (CSR) from the MMS and save to a file.
6. Click 'Choose File' and select the CSR you just downloaded.
7. Click 'Continue'.
8. Click 'Download' to download the payment processing certificate and save to a file.
9. Upload the payment processing certificate to the MMS.

### Google Pay configuration 

Google Pay requires no specific configuration however you must use your Google Merchant Identifier, our Gateway identifier of ‘crst’, and the correct Merchant Account identifier when
configuring your Google Pay enabled application.

If you have not yet obtained your [Google Merchant identifier](https://pay.google.com/business/console/), please create this before proceeding.

Once created, this will need to be entered in the Google Pay Preferences section in the MMS (found on Digital Wallets tab of the Preferences page)

## Implementation

### Request Fields

Digital Wallet payments require the secure payment token generated by the wallet enabled application to be sent to the Gateway in the `paymentToken` field. The type of token must be
specified by also sending the `paymentMethod` field with a value of ‘applepay’ or ‘googlepay’.

| Name      | Mandatory | Description |
| ----------- | ----------- | ----------- |
| paymentMethod | <span class="badge badge--primary">Yes</span> |The type of payment token sent. <br></br><br></br> Value must be one of: <br></br>applepay – to indicate an Apple Pay token<br></br>googlepay – to indicate a Google Pay token|
| paymentToken | <span class="badge badge--primary">Yes</span> |Must contain the secure payment token produced by the wallet enabled application.|

### Response Fields

There are no additional response fields.

## Digital Wallet Tokens 

Digital Wallet payments operate the same as normal card payments, the main difference is that the card details are passed from the wallet application within an encrypted payment token. Once the Gateway has extracted the card details then it can use it with 3-D Secure and Fraud checking services as normal.

### FPAN/DPAN tokens 

Apple Pay and Google Pay (Mobile) payment tokens contain an EMV tokenised card number also known as a device-specific number (DPAN) rather than the Cardholder’s actual card
number (FPAN). With these tokens the expiry date is the date the DPAN expires rather than the value printed on the Cardholder’s card. The card mask returned by the Gateway will be the
masked DPAN, the Gateway is not able to return the last 4 digits of the FPAN. The card issuing details returned are the same as those of the original FPAN. Google Pay (Web) payment tokens contain the Cardholder’s original card number (FPAN) and expiry date. This means that the card mask and expiry date will be those of the original card.

### AVS/CV2 Checking 

Digital wallet payment tokens do not contain any address or CVV details. The Cardholder’s billing address can be passed in the transaction along with the payment token so that address checking can be performed. The Gateway and Acquirer will not perform CVV checks with these payment tokens effectively disabling CVV checks for the transaction disregarding your preferences.

### 3-D Secure Authentication 

DPAN based tokens will usually contain 3-D Secure data and so the Gateway will send this data to the Acquirer to gain the benefits of an authenticated transaction without the need to challenge the Cardholder. This makes using the digital wallet a much simpler and frictionless method of payment.
FPAN based tokens can be passed to the Gateway’s 3-D Secure processing and undergo the normal authentication journey as a manually entered card number.

### Risk Checking 

Both FPAN and DPAN based tokens can be used with risk checking via Kount in the same manner as a normal card transaction.

### Transaction Lifecycle and Recurring Transactions

Both FPAN and DPAN based tokens will follow the standard transaction lifecycle and can be cancelled, captured, refunded or used as the basis of subsequent transactions in the same
manner as a normal card transaction.


